<html>
    <head>
        <link rel="stylesheet" href="categorical-styles.css">
        <title>Documento de python resaltado</title>
    </head>
    <body>
        <pre><span style='color:darkblue'>#!/usr/bin/env python3</span>
<span style='color:crimson'>"""
Analyze docstrings to detect errors.
If no argument is provided, it does a quick check of docstrings and returns
a csv with all API functions and results of basic checks.
If a function or method is provided in the form "pandas.function",
"pandas.module.class.method", etc. a list of all errors in the docstring for
the specified function or method.
Usage::
    $ ./validate_docstrings.py
    $ ./validate_docstrings.py pandas.DataFrame.head
"""</span>
<span style='color:blueviolet'>from</span> <span style='color:darkgreen'>__future__</span> <span style='color:blueviolet'>import</span> <span style='color:darkgreen'>annotations</span>

<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>argparse</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>doctest</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>glob</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>importlib</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>json</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>os</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>subprocess</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>sys</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>tempfile</span>

<span style='color:blueviolet'>try</span><span style='color:deepskyblue'>:</span>
    <span style='color:blueviolet'>from</span> <span style='color:darkgreen'>io</span> <span style='color:blueviolet'>import</span> <span style='color:darkgreen'>StringIO</span>
<span style='color:blueviolet'>except</span> <span style='color:darkgreen'>ImportError</span><span style='color:deepskyblue'>:</span>
    <span style='color:blueviolet'>from</span> <span style='color:darkgreen'>cStringIO</span> <span style='color:blueviolet'>import</span> <span style='color:darkgreen'>StringIO</span>

<span style='color:darkblue'># Template backend makes matplotlib to not plot anything. This is useful</span>
<span style='color:darkblue'># to avoid that plot windows are open from the doctests while running the</span>
<span style='color:darkblue'># script. Setting here before matplotlib is loaded.</span>
<span style='color:darkblue'># We don't warn for the number of open plots, as none is actually being opened</span>
<span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>environ</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"MPLBACKEND"</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>"Template"</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>matplotlib</span>  <span style='color:darkblue'># isort:skip</span>

<span style='color:darkgreen'>matplotlib</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>rc</span>(<span style='color:crimson'>"figure"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>max_open_warning</span><span style='color:deepskyblue'>=</span><span style='color:turquoise'>10000</span><span style='color:deepskyblue'>)</span>

<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>numpy</span>  <span style='color:darkblue'># isort:skip</span>

<span style='color:darkgreen'>BASE_PATH</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>dirname</span>(<span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>dirname</span>(<span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>abspath</span>(<span style='color:darkgreen'>__file__</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>

<span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>insert</span>(<span style='color:turquoise'>0</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>(<span style='color:darkgreen'>BASE_PATH</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>pandas</span>  <span style='color:darkblue'># isort:skip</span>

<span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>insert</span>(<span style='color:turquoise'>1</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>(<span style='color:darkgreen'>BASE_PATH</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"doc"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"sphinxext"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
<span style='color:blueviolet'>from</span> <span style='color:darkgreen'>numpydoc</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>validate</span> <span style='color:blueviolet'>import</span> <span style='color:darkgreen'>validate</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>Docstring</span>  <span style='color:darkblue'># isort:skip</span>


<span style='color:darkgreen'>PRIVATE_CLASSES</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>[</span><span style='color:crimson'>"NDFrame"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"IndexOpsMixin"</span><span style='color:deepskyblue'>]</span>
<span style='color:darkgreen'>ERROR_MSGS</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>{</span>
    <span style='color:crimson'>"GL04"</span><span style='color:deepskyblue'>:</span> <span style='color:crimson'>"Private classes ({mentioned_private_classes}) should not be "</span>
    <span style='color:crimson'>"mentioned in public docstrings"</span><span style='color:deepskyblue'>,</span>
    <span style='color:crimson'>"SA05"</span><span style='color:deepskyblue'>:</span> <span style='color:crimson'>"{reference_name} in `See Also` section does not need `pandas` "</span>
    <span style='color:crimson'>"prefix, use {right_reference} instead."</span><span style='color:deepskyblue'>,</span>
    <span style='color:crimson'>"EX02"</span><span style='color:deepskyblue'>:</span> <span style='color:crimson'>"Examples do not pass tests:\n{doctest_log}"</span><span style='color:deepskyblue'>,</span>
    <span style='color:crimson'>"EX03"</span><span style='color:deepskyblue'>:</span> <span style='color:crimson'>"flake8 error: {error_code} {error_message}{times_happening}"</span><span style='color:deepskyblue'>,</span>
    <span style='color:crimson'>"EX04"</span><span style='color:deepskyblue'>:</span> <span style='color:crimson'>"Do not import {imported_library}, as it is imported "</span>
    <span style='color:crimson'>"automatically for the examples (numpy as np, pandas as pd)"</span><span style='color:deepskyblue'>,</span>
<span style='color:deepskyblue'>}</span>


<span style='color:blueviolet'>def</span> <span style='color:darkgreen'>pandas_error</span>(<span style='color:darkgreen'>code</span><span style='color:deepskyblue'>,</span> <span style='color:fuchsia'>**</span><span style='color:darkgreen'>kwargs</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:crimson'>"""
    Copy of the numpydoc error function, since ERROR_MSGS can't be updated
    with our custom errors yet.
    """</span>
    <span style='color:blueviolet'>return</span> (<span style='color:darkgreen'>code</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>ERROR_MSGS</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>code</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>format</span>(<span style='color:fuchsia'>**</span><span style='color:darkgreen'>kwargs</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>


<span style='color:blueviolet'>def</span> <span style='color:darkgreen'>get_api_items</span>(<span style='color:darkgreen'>api_doc_fd</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:crimson'>"""
    Yield information about all public API items.
    Parse api.rst file from the documentation, and extract all the functions,
    methods, classes, attributes... This should include all pandas public API.
    Parameters
    ----------
    api_doc_fd : file descriptor
        A file descriptor of the API documentation page, containing the table
        of contents with all the public API.
    Yields
    ------
    name : str
        The name of the object (e.g. 'pandas.Series.str.upper).
    func : function
        The object itself. In most cases this will be a function or method,
        but it can also be classes, properties, cython objects...
    section : str
        The name of the section in the API page where the object item is
        located.
    subsection : str
        The name of the subsection in the API page where the object item is
        located.
    """</span>
    <span style='color:darkgreen'>current_module</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>"pandas"</span>
    <span style='color:darkgreen'>previous_line</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>current_section</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>current_subsection</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>""</span>
    <span style='color:darkgreen'>position</span> <span style='color:deepskyblue'>=</span> <span style='color:blueviolet'>None</span>
    <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>line</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>api_doc_fd</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>line</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>line</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>strip</span>(<span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>line</span><span style='color:deepskyblue'>)</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>previous_line</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>set</span>(<span style='color:darkgreen'>line</span><span style='color:deepskyblue'>)</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>set</span>(<span style='color:crimson'>"-"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>current_section</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>previous_line</span>
                <span style='color:blueviolet'>continue</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>set</span>(<span style='color:darkgreen'>line</span><span style='color:deepskyblue'>)</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>set</span>(<span style='color:crimson'>"~"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>current_subsection</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>previous_line</span>
                <span style='color:blueviolet'>continue</span>

        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>line</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>startswith</span>(<span style='color:crimson'>".. currentmodule::"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>current_module</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>line</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>replace</span>(<span style='color:crimson'>".. currentmodule::"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>""</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>strip</span>(<span style='color:deepskyblue'>)</span>
            <span style='color:blueviolet'>continue</span>

        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>line</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>".. autosummary::"</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>position</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>"autosummary"</span>
            <span style='color:blueviolet'>continue</span>

        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>position</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>"autosummary"</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>line</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>""</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>position</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>"items"</span>
                <span style='color:blueviolet'>continue</span>

        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>position</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>"items"</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>line</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>""</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>position</span> <span style='color:deepskyblue'>=</span> <span style='color:blueviolet'>None</span>
                <span style='color:blueviolet'>continue</span>
            <span style='color:darkgreen'>item</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>line</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>strip</span>(<span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>func</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>importlib</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>import_module</span>(<span style='color:darkgreen'>current_module</span><span style='color:deepskyblue'>)</span>
            <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>part</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>item</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>split</span>(<span style='color:crimson'>"."</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>func</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>getattr</span>(<span style='color:darkgreen'>func</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>part</span><span style='color:deepskyblue'>)</span>

            <span style='color:blueviolet'>yield</span> (
                <span style='color:crimson'>"."</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>(<span style='color:deepskyblue'>[</span><span style='color:darkgreen'>current_module</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>item</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>,</span>
                <span style='color:darkgreen'>func</span><span style='color:deepskyblue'>,</span>
                <span style='color:darkgreen'>current_section</span><span style='color:deepskyblue'>,</span>
                <span style='color:darkgreen'>current_subsection</span><span style='color:deepskyblue'>,</span>
            <span style='color:deepskyblue'>)</span>

        <span style='color:darkgreen'>previous_line</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>line</span>


<span style='color:blueviolet'>class</span> <span style='color:darkgreen'>PandasDocstring</span>(<span style='color:darkgreen'>Docstring</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:deepskyblue'>@</span><span style='color:darkgreen'>property</span>
    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>mentioned_private_classes</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:blueviolet'>return</span> <span style='color:deepskyblue'>[</span><span style='color:darkgreen'>klass</span> <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>klass</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>PRIVATE_CLASSES</span> <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>klass</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>raw_doc</span><span style='color:deepskyblue'>]</span>

    <span style='color:deepskyblue'>@</span><span style='color:darkgreen'>property</span>
    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>examples_errors</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>flags</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>doctest</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>NORMALIZE_WHITESPACE</span> <span style='color:fuchsia'>|</span> <span style='color:darkgreen'>doctest</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>IGNORE_EXCEPTION_DETAIL</span>
        <span style='color:darkgreen'>finder</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>doctest</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>DocTestFinder</span>(<span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>runner</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>doctest</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>DocTestRunner</span>(<span style='color:darkgreen'>optionflags</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>flags</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>context</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>{</span><span style='color:crimson'>"np"</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>numpy</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"pd"</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>pandas</span><span style='color:deepskyblue'>}</span>
        <span style='color:darkgreen'>error_msgs</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>""</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>test</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>finder</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>find</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>raw_doc</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>name</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>globs</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>context</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>f</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>StringIO</span>(<span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>runner</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>run</span>(<span style='color:darkgreen'>test</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>out</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>f</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>error_msgs</span> <span style='color:deepskyblue'>+=</span> <span style='color:darkgreen'>f</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>getvalue</span>(<span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>return</span> <span style='color:darkgreen'>error_msgs</span>

    <span style='color:deepskyblue'>@</span><span style='color:darkgreen'>property</span>
    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>examples_source_code</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>lines</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>doctest</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>DocTestParser</span>(<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>get_examples</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>raw_doc</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>return</span> <span style='color:deepskyblue'>[</span><span style='color:darkgreen'>line</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>source</span> <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>line</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>lines</span><span style='color:deepskyblue'>]</span>

    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>validate_pep8</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:blueviolet'>if</span> <span style='color:blueviolet'>not</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>examples</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>return</span>

        <span style='color:darkblue'># F401 is needed to not generate flake8 errors in examples</span>
        <span style='color:darkblue'># that do not user numpy or pandas</span>
        <span style='color:darkgreen'>content</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>""</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>(
            (
                <span style='color:crimson'>"import numpy as np  # noqa: F401\n"</span><span style='color:deepskyblue'>,</span>
                <span style='color:crimson'>"import pandas as pd  # noqa: F401\n"</span><span style='color:deepskyblue'>,</span>
                <span style='color:fuchsia'>*</span><span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>examples_source_code</span><span style='color:deepskyblue'>,</span>
            <span style='color:deepskyblue'>)</span>
        <span style='color:deepskyblue'>)</span>

        <span style='color:darkgreen'>error_messages</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span>
        <span style='color:blueviolet'>with</span> <span style='color:darkgreen'>tempfile</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>NamedTemporaryFile</span>(<span style='color:darkgreen'>mode</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"w"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>encoding</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"utf-8"</span><span style='color:deepskyblue'>)</span> <span style='color:blueviolet'>as</span> <span style='color:darkgreen'>file</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>file</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:darkgreen'>content</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>file</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>flush</span>(<span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>cmd</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>[</span><span style='color:crimson'>"python"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"-m"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"flake8"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"--quiet"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"--statistics"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>file</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>name</span><span style='color:deepskyblue'>]</span>
            <span style='color:darkgreen'>response</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>subprocess</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>run</span>(<span style='color:darkgreen'>cmd</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>capture_output</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>True</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>text</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>True</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>stdout</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>response</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stdout</span>
            <span style='color:darkgreen'>stdout</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>stdout</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>replace</span>(<span style='color:darkgreen'>file</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>name</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>""</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>messages</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>stdout</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>strip</span>(<span style='color:crimson'>"\n"</span><span style='color:deepskyblue'>)</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>messages</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>error_messages</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(<span style='color:darkgreen'>messages</span><span style='color:deepskyblue'>)</span>

        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>error_message</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>error_messages</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>error_count</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>error_code</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>message</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>error_message</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>split</span>(<span style='color:darkgreen'>maxsplit</span><span style='color:deepskyblue'>=</span><span style='color:turquoise'>2</span><span style='color:deepskyblue'>)</span>
            <span style='color:blueviolet'>yield</span> <span style='color:darkgreen'>error_code</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>message</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>int</span>(<span style='color:darkgreen'>error_count</span><span style='color:deepskyblue'>)</span>


<span style='color:blueviolet'>def</span> <span style='color:darkgreen'>pandas_validate</span>(<span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>str</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:crimson'>"""
    Call the numpydoc validation, and add the errors specific to pandas.
    Parameters
    ----------
    func_name : str
        Name of the object of the docstring to validate.
    Returns
    -------
    dict
        Information about the docstring and the errors found.
    """</span>
    <span style='color:darkgreen'>doc</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>PandasDocstring</span>(<span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>result</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>validate</span>(<span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>)</span>

    <span style='color:darkgreen'>mentioned_errs</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>doc</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>mentioned_private_classes</span>
    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>mentioned_errs</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"errors"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(
            <span style='color:darkgreen'>pandas_error</span>(<span style='color:crimson'>"GL04"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>mentioned_private_classes</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>", "</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>(<span style='color:darkgreen'>mentioned_errs</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
        <span style='color:deepskyblue'>)</span>

    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>doc</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>see_also</span><span style='color:deepskyblue'>:</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>rel_name</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>doc</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>see_also</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>rel_name</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>startswith</span>(<span style='color:crimson'>"pandas."</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"errors"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(
                    <span style='color:darkgreen'>pandas_error</span>(
                        <span style='color:crimson'>"SA05"</span><span style='color:deepskyblue'>,</span>
                        <span style='color:darkgreen'>reference_name</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>rel_name</span><span style='color:deepskyblue'>,</span>
                        <span style='color:darkgreen'>right_reference</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>rel_name</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>len</span>(<span style='color:crimson'>"pandas."</span><span style='color:deepskyblue'>)</span> <span style='color:deepskyblue'>:</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>,</span>
                    <span style='color:deepskyblue'>)</span>
                <span style='color:deepskyblue'>)</span>

    <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"examples_errs"</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>""</span>
    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>doc</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>examples</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"examples_errs"</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>doc</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>examples_errors</span>
        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"examples_errs"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"errors"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(
                <span style='color:darkgreen'>pandas_error</span>(<span style='color:crimson'>"EX02"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>doctest_log</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"examples_errs"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
            <span style='color:deepskyblue'>)</span>

        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>error_code</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>error_message</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>error_count</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>doc</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>validate_pep8</span>(<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>times_happening</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>f" ({error_count} times)"</span> <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>error_count</span> <span style='color:fuchsia'>></span> <span style='color:turquoise'>1</span> <span style='color:blueviolet'>else</span> <span style='color:crimson'>""</span>
            <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"errors"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(
                <span style='color:darkgreen'>pandas_error</span>(
                    <span style='color:crimson'>"EX03"</span><span style='color:deepskyblue'>,</span>
                    <span style='color:darkgreen'>error_code</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>error_code</span><span style='color:deepskyblue'>,</span>
                    <span style='color:darkgreen'>error_message</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>error_message</span><span style='color:deepskyblue'>,</span>
                    <span style='color:darkgreen'>times_happening</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>times_happening</span><span style='color:deepskyblue'>,</span>
                <span style='color:deepskyblue'>)</span>
            <span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>examples_source_code</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>""</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>(<span style='color:darkgreen'>doc</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>examples_source_code</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>wrong_import</span> <span style='color:blueviolet'>in</span> (<span style='color:crimson'>"numpy"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"pandas"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>if</span> <span style='color:crimson'>f"import {wrong_import}"</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>examples_source_code</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"errors"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(
                    <span style='color:darkgreen'>pandas_error</span>(<span style='color:crimson'>"EX04"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>imported_library</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>wrong_import</span><span style='color:deepskyblue'>)</span>
                <span style='color:deepskyblue'>)</span>

    <span style='color:blueviolet'>return</span> <span style='color:darkgreen'>result</span>


<span style='color:blueviolet'>def</span> <span style='color:darkgreen'>validate_all</span>(<span style='color:darkgreen'>prefix</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>ignore_deprecated</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>False</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:crimson'>"""
    Execute the validation of all docstrings, and return a dict with the
    results.
    Parameters
    ----------
    prefix : str or None
        If provided, only the docstrings that start with this pattern will be
        validated. If None, all docstrings will be validated.
    ignore_deprecated: bool, default False
        If True, deprecated objects are ignored when validating docstrings.
    Returns
    -------
    dict
        A dictionary with an item for every function/method... containing
        all the validation information.
    """</span>
    <span style='color:darkgreen'>result</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>{</span><span style='color:deepskyblue'>}</span>
    <span style='color:darkgreen'>seen</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>{</span><span style='color:deepskyblue'>}</span>

    <span style='color:darkgreen'>api_doc_fnames</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>(<span style='color:darkgreen'>BASE_PATH</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"doc"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"source"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"reference"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"*.rst"</span><span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>api_items</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span>
    <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>api_doc_fname</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>glob</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>glob</span>(<span style='color:darkgreen'>api_doc_fnames</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:blueviolet'>with</span> <span style='color:darkgreen'>open</span>(<span style='color:darkgreen'>api_doc_fname</span><span style='color:deepskyblue'>)</span> <span style='color:blueviolet'>as</span> <span style='color:darkgreen'>f</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>api_items</span> <span style='color:deepskyblue'>+=</span> <span style='color:darkgreen'>list</span>(<span style='color:darkgreen'>get_api_items</span>(<span style='color:darkgreen'>f</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>

    <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>func_obj</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>section</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>subsection</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>api_items</span><span style='color:deepskyblue'>:</span>
        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>prefix</span> <span style='color:blueviolet'>and</span> <span style='color:blueviolet'>not</span> <span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>startswith</span>(<span style='color:darkgreen'>prefix</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>continue</span>
        <span style='color:darkgreen'>doc_info</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>pandas_validate</span>(<span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>ignore_deprecated</span> <span style='color:blueviolet'>and</span> <span style='color:darkgreen'>doc_info</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"deprecated"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>continue</span>
        <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>doc_info</span>

        <span style='color:darkgreen'>shared_code_key</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>doc_info</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"file"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>doc_info</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"file_line"</span><span style='color:deepskyblue'>]</span>
        <span style='color:darkgreen'>shared_code</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>seen</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>get</span>(<span style='color:darkgreen'>shared_code_key</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>""</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>update</span>(
            <span style='color:deepskyblue'>{</span>
                <span style='color:crimson'>"in_api"</span><span style='color:deepskyblue'>:</span> <span style='color:blueviolet'>True</span><span style='color:deepskyblue'>,</span>
                <span style='color:crimson'>"section"</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>section</span><span style='color:deepskyblue'>,</span>
                <span style='color:crimson'>"subsection"</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>subsection</span><span style='color:deepskyblue'>,</span>
                <span style='color:crimson'>"shared_code_with"</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>shared_code</span><span style='color:deepskyblue'>,</span>
            <span style='color:deepskyblue'>}</span>
        <span style='color:deepskyblue'>)</span>

        <span style='color:darkgreen'>seen</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>shared_code_key</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>func_name</span>

    <span style='color:blueviolet'>return</span> <span style='color:darkgreen'>result</span>


<span style='color:blueviolet'>def</span> <span style='color:darkgreen'>print_validate_all_results</span>(
    <span style='color:darkgreen'>prefix</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>str</span><span style='color:deepskyblue'>,</span>
    <span style='color:darkgreen'>errors</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>list</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>str</span><span style='color:deepskyblue'>]</span> <span style='color:fuchsia'>|</span> <span style='color:blueviolet'>None</span><span style='color:deepskyblue'>,</span>
    <span style='color:darkgreen'>output_format</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>str</span><span style='color:deepskyblue'>,</span>
    <span style='color:darkgreen'>ignore_deprecated</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>bool</span><span style='color:deepskyblue'>,</span>
<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>output_format</span> <span style='color:blueviolet'>not</span> <span style='color:blueviolet'>in</span> (<span style='color:crimson'>"default"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"json"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"actions"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:blueviolet'>raise</span> <span style='color:darkgreen'>ValueError</span>(<span style='color:crimson'>f'Unknown output_format "{output_format}"'</span><span style='color:deepskyblue'>)</span>

    <span style='color:darkgreen'>result</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>validate_all</span>(<span style='color:darkgreen'>prefix</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>ignore_deprecated</span><span style='color:deepskyblue'>)</span>

    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>output_format</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>"json"</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stdout</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:darkgreen'>json</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>dumps</span>(<span style='color:darkgreen'>result</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>return</span> <span style='color:turquoise'>0</span>

    <span style='color:darkgreen'>prefix</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>"##[error]"</span> <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>output_format</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>"actions"</span> <span style='color:blueviolet'>else</span> <span style='color:crimson'>""</span>
    <span style='color:darkgreen'>exit_status</span> <span style='color:deepskyblue'>=</span> <span style='color:turquoise'>0</span>
    <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>name</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>res</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>items</span>(<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>err_code</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>err_desc</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>res</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"errors"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>errors</span> <span style='color:blueviolet'>and</span> <span style='color:darkgreen'>err_code</span> <span style='color:blueviolet'>not</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>errors</span><span style='color:deepskyblue'>:</span>
                <span style='color:blueviolet'>continue</span>
            <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stdout</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(
                <span style='color:crimson'>f'{prefix}{res["file"]}:{res["file_line"]}:'</span>
                <span style='color:crimson'>f"{err_code}:{name}:{err_desc}\n"</span>
            <span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>exit_status</span> <span style='color:deepskyblue'>+=</span> <span style='color:turquoise'>1</span>

    <span style='color:blueviolet'>return</span> <span style='color:darkgreen'>exit_status</span>


<span style='color:blueviolet'>def</span> <span style='color:darkgreen'>print_validate_one_results</span>(<span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>str</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>header</span>(<span style='color:darkgreen'>title</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>width</span><span style='color:deepskyblue'>=</span><span style='color:turquoise'>80</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>char</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"#"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>full_line</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>char</span> <span style='color:fuchsia'>*</span> <span style='color:darkgreen'>width</span>
        <span style='color:darkgreen'>side_len</span> <span style='color:deepskyblue'>=</span> (<span style='color:darkgreen'>width</span> <span style='color:fuchsia'>-</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>title</span><span style='color:deepskyblue'>)</span> <span style='color:fuchsia'>-</span> <span style='color:turquoise'>2</span><span style='color:deepskyblue'>)</span> <span style='color:fuchsia'>//</span> <span style='color:turquoise'>2</span>
        <span style='color:darkgreen'>adj</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>""</span> <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>title</span><span style='color:deepskyblue'>)</span> <span style='color:fuchsia'>%</span> <span style='color:turquoise'>2</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:turquoise'>0</span> <span style='color:blueviolet'>else</span> <span style='color:crimson'>" "</span>
        <span style='color:darkgreen'>title_line</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>f"{char * side_len} {title}{adj} {char * side_len}"</span>

        <span style='color:blueviolet'>return</span> <span style='color:crimson'>f"\n{full_line}\n{title_line}\n{full_line}\n\n"</span>

    <span style='color:darkgreen'>result</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>pandas_validate</span>(<span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>)</span>

    <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:darkgreen'>header</span>(<span style='color:crimson'>f"Docstring ({func_name})"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:crimson'>f"{result['docstring']}\n"</span><span style='color:deepskyblue'>)</span>

    <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:darkgreen'>header</span>(<span style='color:crimson'>"Validation"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"errors"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:crimson'>f'{len(result["errors"])} Errors found:\n'</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>err_code</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>err_desc</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"errors"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>err_code</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>"EX02"</span><span style='color:deepskyblue'>:</span>  <span style='color:darkblue'># Failing examples are printed at the end</span>
                <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:crimson'>"\tExamples do not pass tests\n"</span><span style='color:deepskyblue'>)</span>
                <span style='color:blueviolet'>continue</span>
            <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:crimson'>f"\t{err_desc}\n"</span><span style='color:deepskyblue'>)</span>
    <span style='color:blueviolet'>else</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:crimson'>f'Docstring for "{func_name}" correct. :)\n'</span><span style='color:deepskyblue'>)</span>

    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"examples_errs"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:darkgreen'>header</span>(<span style='color:crimson'>"Doctests"</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>stderr</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>write</span>(<span style='color:darkgreen'>result</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>"examples_errs"</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>


<span style='color:blueviolet'>def</span> <span style='color:darkgreen'>main</span>(<span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prefix</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>errors</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>output_format</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>ignore_deprecated</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:crimson'>"""
    Main entry point. Call the validation for one or for all docstrings.
    """</span>
    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>func_name</span> <span style='color:blueviolet'>is</span> <span style='color:blueviolet'>None</span><span style='color:deepskyblue'>:</span>
        <span style='color:blueviolet'>return</span> <span style='color:darkgreen'>print_validate_all_results</span>(
            <span style='color:darkgreen'>prefix</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>errors</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>output_format</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>ignore_deprecated</span>
        <span style='color:deepskyblue'>)</span>
    <span style='color:blueviolet'>else</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>print_validate_one_results</span>(<span style='color:darkgreen'>func_name</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>return</span> <span style='color:turquoise'>0</span>


<span style='color:blueviolet'>if</span> <span style='color:darkgreen'>__name__</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>"__main__"</span><span style='color:deepskyblue'>:</span>
    <span style='color:darkgreen'>format_opts</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>"default"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"json"</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>"actions"</span>
    <span style='color:darkgreen'>func_help</span> <span style='color:deepskyblue'>=</span> (
        <span style='color:crimson'>"function or method to validate (e.g. pandas.DataFrame.head) "</span>
        <span style='color:crimson'>"if not provided, all docstrings are validated and returned "</span>
        <span style='color:crimson'>"as JSON"</span>
    <span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>argparser</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>argparse</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>ArgumentParser</span>(<span style='color:darkgreen'>description</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"validate pandas docstrings"</span><span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>argparser</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>add_argument</span>(<span style='color:crimson'>"function"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>nargs</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"?"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>default</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>None</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>help</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>func_help</span><span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>argparser</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>add_argument</span>(
        <span style='color:crimson'>"--format"</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>default</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"default"</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>choices</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>format_opts</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>help</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"format of the output when validating "</span>
        <span style='color:crimson'>"multiple docstrings (ignored when validating one). "</span>
        <span style='color:crimson'>"It can be {str(format_opts)[1:-1]}"</span><span style='color:deepskyblue'>,</span>
    <span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>argparser</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>add_argument</span>(
        <span style='color:crimson'>"--prefix"</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>default</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>None</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>help</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"pattern for the "</span>
        <span style='color:crimson'>"docstring names, in order to decide which ones "</span>
        <span style='color:crimson'>'will be validated. A prefix "pandas.Series.str."'</span>
        <span style='color:crimson'>"will make the script validate all the docstrings "</span>
        <span style='color:crimson'>"of methods starting by this pattern. It is "</span>
        <span style='color:crimson'>"ignored if parameter function is provided"</span><span style='color:deepskyblue'>,</span>
    <span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>argparser</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>add_argument</span>(
        <span style='color:crimson'>"--errors"</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>default</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>None</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>help</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"comma separated "</span>
        <span style='color:crimson'>"list of error codes to validate. By default it "</span>
        <span style='color:crimson'>"validates all errors (ignored when validating "</span>
        <span style='color:crimson'>"a single docstring)"</span><span style='color:deepskyblue'>,</span>
    <span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>argparser</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>add_argument</span>(
        <span style='color:crimson'>"--ignore_deprecated"</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>default</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>False</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>action</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"store_true"</span><span style='color:deepskyblue'>,</span>
        <span style='color:darkgreen'>help</span><span style='color:deepskyblue'>=</span><span style='color:crimson'>"if this flag is set, "</span>
        <span style='color:crimson'>"deprecated objects are ignored when validating "</span>
        <span style='color:crimson'>"all docstrings"</span><span style='color:deepskyblue'>,</span>
    <span style='color:deepskyblue'>)</span>

    <span style='color:darkgreen'>args</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>argparser</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>parse_args</span>(<span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>sys</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>exit</span>(
        <span style='color:darkgreen'>main</span>(
            <span style='color:darkgreen'>args</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>function</span><span style='color:deepskyblue'>,</span>
            <span style='color:darkgreen'>args</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>prefix</span><span style='color:deepskyblue'>,</span>
            <span style='color:darkgreen'>args</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>errors</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>split</span>(<span style='color:crimson'>","</span><span style='color:deepskyblue'>)</span> <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>args</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>errors</span> <span style='color:blueviolet'>else</span> <span style='color:blueviolet'>None</span><span style='color:deepskyblue'>,</span>
            <span style='color:darkgreen'>args</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>format</span><span style='color:deepskyblue'>,</span>
            <span style='color:darkgreen'>args</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>ignore_deprecated</span><span style='color:deepskyblue'>,</span>
        <span style='color:deepskyblue'>)</span>
    <span style='color:deepskyblue'>)</span>
        </pre>
    </body>
</html>