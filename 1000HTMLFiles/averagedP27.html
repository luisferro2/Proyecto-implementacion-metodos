<html>
    <head>
        <link rel="stylesheet" href="categorical-styles.css">
        <title>Documento de python resaltado</title>
    </head>
    <body>
        <pre><span style='color:darkblue'># -*- coding:utf-8 -*-</span>
<span style='color:darkblue'># Filename: PerceptronTagger.py</span>
<span style='color:darkblue'># Authorï¼šhankcs</span>
<span style='color:darkblue'># Date: 2016-09-03 PM2:22</span>
<span style='color:blueviolet'>from</span> <span style='color:darkgreen'>__future__</span> <span style='color:blueviolet'>import</span> <span style='color:darkgreen'>absolute_import</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>os</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>random</span>
<span style='color:blueviolet'>from</span> <span style='color:darkgreen'>collections</span> <span style='color:blueviolet'>import</span> <span style='color:darkgreen'>defaultdict</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>pickle</span>
<span style='color:blueviolet'>import</span> <span style='color:darkgreen'>logging</span>

<span style='color:blueviolet'>from</span> <span style='color:darkgreen'>AveragedPerceptron</span> <span style='color:blueviolet'>import</span> <span style='color:darkgreen'>AveragedPerceptron</span>

<span style='color:darkgreen'>PICKLE</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>"data/trontagger-0.1.0.pickle"</span>


<span style='color:blueviolet'>class</span> <span style='color:darkgreen'>PerceptronTagger</span>(<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:crimson'>'''Greedy Averaged Perceptron tagger, as implemented by Matthew Honnibal.
    See more implementation details here:
        http://honnibal.wordpress.com/2013/09/11/a-good-part-of-speechpos-tagger-in-about-200-lines-of-python/
    :param load: Load the pickled model upon instantiation.
    '''</span>

    <span style='color:darkgreen'>START</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>[</span><span style='color:crimson'>'-START-'</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>'-START2-'</span><span style='color:deepskyblue'>]</span>
    <span style='color:darkgreen'>END</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>[</span><span style='color:crimson'>'-END-'</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>'-END2-'</span><span style='color:deepskyblue'>]</span>
    <span style='color:darkgreen'>AP_MODEL_LOC</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>(<span style='color:darkgreen'>os</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>path</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>dirname</span>(<span style='color:darkgreen'>__file__</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>PICKLE</span><span style='color:deepskyblue'>)</span>

    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>__init__</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>load</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>True</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>AveragedPerceptron</span>(<span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>tagdict</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>{</span><span style='color:deepskyblue'>}</span>
        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>classes</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>set</span>(<span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>load</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>load</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>AP_MODEL_LOC</span><span style='color:deepskyblue'>)</span>

    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>tag</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>corpus</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:crimson'>'''Tags a string `corpus`.'''</span>
        <span style='color:darkblue'># Assume untokenized corpus has \n between sentences and ' ' between words</span>
        <span style='color:darkgreen'>s_split</span> <span style='color:deepskyblue'>=</span> <span style='color:blueviolet'>lambda</span> <span style='color:darkgreen'>t</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>t</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>split</span>(<span style='color:crimson'>'\n'</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>w_split</span> <span style='color:deepskyblue'>=</span> <span style='color:blueviolet'>lambda</span> <span style='color:darkgreen'>s</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>s</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>split</span>(<span style='color:deepskyblue'>)</span>

        <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>split_sents</span>(<span style='color:darkgreen'>corpus</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>s</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>s_split</span>(<span style='color:darkgreen'>corpus</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                <span style='color:blueviolet'>yield</span> <span style='color:darkgreen'>w_split</span>(<span style='color:darkgreen'>s</span><span style='color:deepskyblue'>)</span>

        <span style='color:darkgreen'>prev</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev2</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>START</span>
        <span style='color:darkgreen'>tokens</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>words</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>split_sents</span>(<span style='color:darkgreen'>corpus</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>context</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>START</span> <span style='color:fuchsia'>+</span> <span style='color:deepskyblue'>[</span><span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>_normalize</span>(<span style='color:darkgreen'>w</span><span style='color:deepskyblue'>)</span> <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>w</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>words</span><span style='color:deepskyblue'>]</span> <span style='color:fuchsia'>+</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>END</span>
            <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>i</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>enumerate</span>(<span style='color:darkgreen'>words</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>tag</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>tagdict</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>get</span>(<span style='color:darkgreen'>word</span><span style='color:deepskyblue'>)</span>
                <span style='color:blueviolet'>if</span> <span style='color:blueviolet'>not</span> <span style='color:darkgreen'>tag</span><span style='color:deepskyblue'>:</span>
                    <span style='color:darkgreen'>features</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>_get_features</span>(<span style='color:darkgreen'>i</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev2</span><span style='color:deepskyblue'>)</span>
                    <span style='color:darkgreen'>tag</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>predict</span>(<span style='color:darkgreen'>features</span><span style='color:deepskyblue'>)</span>
                <span style='color:darkgreen'>tokens</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>((<span style='color:darkgreen'>word</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>tag</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
                <span style='color:darkgreen'>prev2</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>prev</span>
                <span style='color:darkgreen'>prev</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>tag</span>
        <span style='color:blueviolet'>return</span> <span style='color:darkgreen'>tokens</span>

    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>train</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>sentences</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>save_loc</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>None</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>nr_iter</span><span style='color:deepskyblue'>=</span><span style='color:turquoise'>5</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:crimson'>'''Train a model from sentences, and save it at ``save_loc``. ``nr_iter``
        controls the number of Perceptron training iterations.
        :param sentences: A list of (words, tags) tuples.
        :param save_loc: If not ``None``, saves a pickled model in this location.
        :param nr_iter: Number of training iterations.
        '''</span>
        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>_make_tagdict</span>(<span style='color:darkgreen'>sentences</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>classes</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>classes</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>iter_</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>range</span>(<span style='color:darkgreen'>nr_iter</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>c</span> <span style='color:deepskyblue'>=</span> <span style='color:turquoise'>0</span>
            <span style='color:darkgreen'>n</span> <span style='color:deepskyblue'>=</span> <span style='color:turquoise'>0</span>
            <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>words</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>tags</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>sentences</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>prev</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev2</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>START</span>
                <span style='color:darkgreen'>context</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>START</span> <span style='color:fuchsia'>+</span> <span style='color:deepskyblue'>[</span><span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>_normalize</span>(<span style='color:darkgreen'>w</span><span style='color:deepskyblue'>)</span> <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>w</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>words</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>\</span>
                          <span style='color:fuchsia'>+</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>END</span>
                <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>i</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>enumerate</span>(<span style='color:darkgreen'>words</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                    <span style='color:darkgreen'>guess</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>tagdict</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>get</span>(<span style='color:darkgreen'>word</span><span style='color:deepskyblue'>)</span>
                    <span style='color:blueviolet'>if</span> <span style='color:blueviolet'>not</span> <span style='color:darkgreen'>guess</span><span style='color:deepskyblue'>:</span>
                        <span style='color:darkgreen'>feats</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>_get_features</span>(<span style='color:darkgreen'>i</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev2</span><span style='color:deepskyblue'>)</span>
                        <span style='color:darkgreen'>guess</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>predict</span>(<span style='color:darkgreen'>feats</span><span style='color:deepskyblue'>)</span>
                        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>update</span>(<span style='color:darkgreen'>tags</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>guess</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>feats</span><span style='color:deepskyblue'>)</span>
                    <span style='color:darkgreen'>prev2</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>prev</span>
                    <span style='color:darkgreen'>prev</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>guess</span>
                    <span style='color:darkgreen'>c</span> <span style='color:deepskyblue'>+=</span> <span style='color:darkgreen'>guess</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>tags</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span><span style='color:deepskyblue'>]</span>
                    <span style='color:darkgreen'>n</span> <span style='color:deepskyblue'>+=</span> <span style='color:turquoise'>1</span>
            <span style='color:darkgreen'>random</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>shuffle</span>(<span style='color:darkgreen'>sentences</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>logging</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>info</span>(<span style='color:crimson'>"Iter {0}: {1}/{2}={3}"</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>format</span>(<span style='color:darkgreen'>iter_</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>c</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>n</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>_pc</span>(<span style='color:darkgreen'>c</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>n</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>average_weights</span>(<span style='color:deepskyblue'>)</span>
        <span style='color:darkblue'># Pickle as a binary file</span>
        <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>save_loc</span> <span style='color:blueviolet'>is</span> <span style='color:blueviolet'>not</span> <span style='color:blueviolet'>None</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>pickle</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>dump</span>((<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>weights</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>tagdict</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>classes</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>,</span>
                        <span style='color:darkgreen'>open</span>(<span style='color:darkgreen'>save_loc</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>'wb'</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>,</span> <span style='color:fuchsia'>-</span><span style='color:turquoise'>1</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>return</span> <span style='color:blueviolet'>None</span>

    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>load</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>loc</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:crimson'>'''Load a pickled model.'''</span>
        <span style='color:blueviolet'>try</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>w_td_c</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>pickle</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>load</span>(<span style='color:darkgreen'>open</span>(<span style='color:darkgreen'>loc</span><span style='color:deepskyblue'>,</span> <span style='color:crimson'>'rb'</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>except</span> <span style='color:darkgreen'>IOError</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>msg</span> <span style='color:deepskyblue'>=</span> (<span style='color:crimson'>"Missing trontagger.pickle file."</span><span style='color:deepskyblue'>)</span>
            <span style='color:blueviolet'>raise</span> <span style='color:darkgreen'>IOError</span>(<span style='color:darkgreen'>msg</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>weights</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>tagdict</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>classes</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>w_td_c</span>
        <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>model</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>classes</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>classes</span>
        <span style='color:blueviolet'>return</span> <span style='color:blueviolet'>None</span>

    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>_normalize</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:crimson'>'''Normalization used in pre-processing.
        - All words are lower cased
        - Digits in the range 1800-2100 are represented as !YEAR;
        - Other digits are represented as !DIGITS
        :rtype: str
        '''</span>
        <span style='color:blueviolet'>if</span> <span style='color:crimson'>'-'</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>word</span> <span style='color:blueviolet'>and</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span> <span style='color:fuchsia'>!=</span> <span style='color:crimson'>'-'</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>return</span> <span style='color:crimson'>'!HYPHEN'</span>
        <span style='color:blueviolet'>elif</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>isdigit</span>(<span style='color:deepskyblue'>)</span> <span style='color:blueviolet'>and</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>word</span><span style='color:deepskyblue'>)</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:turquoise'>4</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>return</span> <span style='color:crimson'>'!YEAR'</span>
        <span style='color:blueviolet'>elif</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>isdigit</span>(<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>return</span> <span style='color:crimson'>'!DIGITS'</span>
        <span style='color:blueviolet'>else</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>return</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>lower</span>(<span style='color:deepskyblue'>)</span>

    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>_get_features</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>i</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev2</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:crimson'>'''Map tokens into a feature representation, implemented as a
        {hashable: float} dict. If the features change, a new model must be
        trained.
        '''</span>

        <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>add</span>(<span style='color:darkgreen'>name</span><span style='color:deepskyblue'>,</span> <span style='color:fuchsia'>*</span><span style='color:darkgreen'>args</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>features</span><span style='color:deepskyblue'>[</span><span style='color:crimson'>' '</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>join</span>((<span style='color:darkgreen'>name</span><span style='color:deepskyblue'>,</span><span style='color:deepskyblue'>)</span> <span style='color:fuchsia'>+</span> <span style='color:darkgreen'>tuple</span>(<span style='color:darkgreen'>args</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>+=</span> <span style='color:turquoise'>1</span>

        <span style='color:darkgreen'>i</span> <span style='color:deepskyblue'>+=</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>START</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>features</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>defaultdict</span>(<span style='color:darkgreen'>int</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkblue'># It's useful to have a constant feature, which acts sort of like a prior</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'bias'</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i suffix'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>[</span><span style='color:fuchsia'>-</span><span style='color:turquoise'>3</span><span style='color:deepskyblue'>:</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i pref1'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i-1 tag'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i-2 tag'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev2</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i tag+i-2 tag'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev2</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i word'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i-1 tag+i word'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>prev</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i-1 word'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span> <span style='color:fuchsia'>-</span> <span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i-1 suffix'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span> <span style='color:fuchsia'>-</span> <span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>[</span><span style='color:fuchsia'>-</span><span style='color:turquoise'>3</span><span style='color:deepskyblue'>:</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i-2 word'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span> <span style='color:fuchsia'>-</span> <span style='color:turquoise'>2</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i+1 word'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span> <span style='color:fuchsia'>+</span> <span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i+1 suffix'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span> <span style='color:fuchsia'>+</span> <span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>[</span><span style='color:fuchsia'>-</span><span style='color:turquoise'>3</span><span style='color:deepskyblue'>:</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>add</span>(<span style='color:crimson'>'i+2 word'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>context</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>i</span> <span style='color:fuchsia'>+</span> <span style='color:turquoise'>2</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>return</span> <span style='color:darkgreen'>features</span>

    <span style='color:blueviolet'>def</span> <span style='color:darkgreen'>_make_tagdict</span>(<span style='color:darkgreen'>self</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>sentences</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
        <span style='color:crimson'>'''Make a tag dictionary for single-tag words.'''</span>
        <span style='color:darkgreen'>counts</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>defaultdict</span>(<span style='color:blueviolet'>lambda</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>defaultdict</span>(<span style='color:darkgreen'>int</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>words</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>tags</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>sentences</span><span style='color:deepskyblue'>:</span>
            <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>tag</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>zip</span>(<span style='color:darkgreen'>words</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>tags</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>counts</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>word</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>tag</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>+=</span> <span style='color:turquoise'>1</span>
                <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>classes</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>add</span>(<span style='color:darkgreen'>tag</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>freq_thresh</span> <span style='color:deepskyblue'>=</span> <span style='color:turquoise'>20</span>
        <span style='color:darkgreen'>ambiguity_thresh</span> <span style='color:deepskyblue'>=</span> <span style='color:saddlebrown'>0.97</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>word</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>tag_freqs</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>counts</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>items</span>(<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>tag</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>mode</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>max</span>(<span style='color:darkgreen'>tag_freqs</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>items</span>(<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>key</span><span style='color:deepskyblue'>=</span><span style='color:blueviolet'>lambda</span> <span style='color:darkgreen'>item</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>item</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>n</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>sum</span>(<span style='color:darkgreen'>tag_freqs</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>values</span>(<span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkblue'># Don't add rare words to the tag dictionary</span>
            <span style='color:darkblue'># Only add quite unambiguous words</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>n</span> <span style='color:deepskyblue'>&gt=</span> <span style='color:darkgreen'>freq_thresh</span> <span style='color:blueviolet'>and</span> (<span style='color:darkgreen'>float</span>(<span style='color:darkgreen'>mode</span><span style='color:deepskyblue'>)</span> <span style='color:fuchsia'>/</span> <span style='color:darkgreen'>n</span><span style='color:deepskyblue'>)</span> <span style='color:deepskyblue'>&gt=</span> <span style='color:darkgreen'>ambiguity_thresh</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>self</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>tagdict</span><span style='color:deepskyblue'>[</span><span style='color:darkgreen'>word</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>tag</span>


<span style='color:blueviolet'>def</span> <span style='color:darkgreen'>_pc</span>(<span style='color:darkgreen'>n</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>d</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
    <span style='color:blueviolet'>return</span> (<span style='color:darkgreen'>float</span>(<span style='color:darkgreen'>n</span><span style='color:deepskyblue'>)</span> <span style='color:fuchsia'>/</span> <span style='color:darkgreen'>d</span><span style='color:deepskyblue'>)</span> <span style='color:fuchsia'>*</span> <span style='color:turquoise'>100</span>


<span style='color:blueviolet'>if</span> <span style='color:darkgreen'>__name__</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>'__main__'</span><span style='color:deepskyblue'>:</span>
    <span style='color:darkgreen'>logging</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>basicConfig</span>(<span style='color:darkgreen'>level</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>logging</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>INFO</span><span style='color:deepskyblue'>)</span>
    <span style='color:darkgreen'>tagger</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>PerceptronTagger</span>(<span style='color:blueviolet'>False</span><span style='color:deepskyblue'>)</span>
    <span style='color:blueviolet'>try</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>tagger</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>load</span>(<span style='color:darkgreen'>PICKLE</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>print</span>(<span style='color:darkgreen'>tagger</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>tag</span>(<span style='color:crimson'>'how are you ?'</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>logging</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>info</span>(<span style='color:crimson'>'Start testing...'</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>right</span> <span style='color:deepskyblue'>=</span> <span style='color:saddlebrown'>0.0</span>
        <span style='color:darkgreen'>total</span> <span style='color:deepskyblue'>=</span> <span style='color:saddlebrown'>0.0</span>
        <span style='color:darkgreen'>sentence</span> <span style='color:deepskyblue'>=</span> (<span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>,</span> <span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>line</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>open</span>(<span style='color:crimson'>'data/test.txt'</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>params</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>line</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>split</span>(<span style='color:deepskyblue'>)</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>params</span><span style='color:deepskyblue'>)</span> <span style='color:fuchsia'>!=</span> <span style='color:turquoise'>2</span><span style='color:deepskyblue'>:</span> <span style='color:blueviolet'>continue</span>
            <span style='color:darkgreen'>sentence</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(<span style='color:darkgreen'>params</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>sentence</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(<span style='color:darkgreen'>params</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>params</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>'.'</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>text</span> <span style='color:deepskyblue'>=</span> <span style='color:crimson'>''</span>
                <span style='color:darkgreen'>words</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>sentence</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span>
                <span style='color:darkgreen'>tags</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>sentence</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span>
                <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>i</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>word</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>enumerate</span>(<span style='color:darkgreen'>words</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                    <span style='color:darkgreen'>text</span> <span style='color:deepskyblue'>+=</span> <span style='color:darkgreen'>word</span>
                    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>i</span> <span style='color:fuchsia'>&lt</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>words</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>text</span> <span style='color:deepskyblue'>+=</span> <span style='color:crimson'>' '</span>
                <span style='color:darkgreen'>outputs</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>tagger</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>tag</span>(<span style='color:darkgreen'>text</span><span style='color:deepskyblue'>)</span>
                <span style='color:blueviolet'>assert</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>tags</span><span style='color:deepskyblue'>)</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>outputs</span><span style='color:deepskyblue'>)</span>
                <span style='color:darkgreen'>total</span> <span style='color:deepskyblue'>+=</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>tags</span><span style='color:deepskyblue'>)</span>
                <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>o</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>t</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>zip</span>(<span style='color:darkgreen'>outputs</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>tags</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
                    <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>o</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>strip</span>(<span style='color:deepskyblue'>)</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>t</span><span style='color:deepskyblue'>:</span> <span style='color:darkgreen'>right</span> <span style='color:deepskyblue'>+=</span> <span style='color:turquoise'>1</span>
                <span style='color:darkgreen'>sentence</span> <span style='color:deepskyblue'>=</span> (<span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>,</span> <span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>logging</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>info</span>(<span style='color:crimson'>"Precision : %f"</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>right</span> <span style='color:fuchsia'>/</span> <span style='color:darkgreen'>total</span><span style='color:deepskyblue'>)</span>
    <span style='color:blueviolet'>except</span> <span style='color:darkgreen'>IOError</span><span style='color:deepskyblue'>:</span>
        <span style='color:darkgreen'>logging</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>info</span>(<span style='color:crimson'>'Reading corpus...'</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>training_data</span> <span style='color:deepskyblue'>=</span> <span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span>
        <span style='color:darkgreen'>sentence</span> <span style='color:deepskyblue'>=</span> (<span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>,</span> <span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:blueviolet'>for</span> <span style='color:darkgreen'>line</span> <span style='color:blueviolet'>in</span> <span style='color:darkgreen'>open</span>(<span style='color:crimson'>'data/train.txt'</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>:</span>
            <span style='color:darkgreen'>params</span> <span style='color:deepskyblue'>=</span> <span style='color:darkgreen'>line</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>split</span>(<span style='color:crimson'>'\t'</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>sentence</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(<span style='color:darkgreen'>params</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
            <span style='color:darkgreen'>sentence</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(<span style='color:darkgreen'>params</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>1</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
            <span style='color:blueviolet'>if</span> <span style='color:darkgreen'>params</span><span style='color:deepskyblue'>[</span><span style='color:turquoise'>0</span><span style='color:deepskyblue'>]</span> <span style='color:deepskyblue'>=</span><span style='color:deepskyblue'>=</span> <span style='color:crimson'>'.'</span><span style='color:deepskyblue'>:</span>
                <span style='color:darkgreen'>training_data</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>append</span>(<span style='color:darkgreen'>sentence</span><span style='color:deepskyblue'>)</span>
                <span style='color:darkgreen'>sentence</span> <span style='color:deepskyblue'>=</span> (<span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>,</span> <span style='color:deepskyblue'>[</span><span style='color:deepskyblue'>]</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>logging</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>info</span>(<span style='color:crimson'>'training corpus size : %d'</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>len</span>(<span style='color:darkgreen'>training_data</span><span style='color:deepskyblue'>)</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>logging</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>info</span>(<span style='color:crimson'>'Start training...'</span><span style='color:deepskyblue'>)</span>
        <span style='color:darkgreen'>tagger</span><span style='color:deepskyblue'>.</span><span style='color:darkgreen'>train</span>(<span style='color:darkgreen'>training_data</span><span style='color:deepskyblue'>,</span> <span style='color:darkgreen'>save_loc</span><span style='color:deepskyblue'>=</span><span style='color:darkgreen'>PICKLE</span><span style='color:deepskyblue'>)</span>

        </pre>
    </body>
</html>